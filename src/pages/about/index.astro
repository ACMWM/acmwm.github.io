---
import Layout from '@layouts/Default.astro';
import { getActiveOfficerProfilesFromSheets } from "../../scripts/googleSheets";
import '../../styles/global.css';
import '../../styles/about.css';
import PageHeader from "../../components/layout/PageHeader.astro";

// 1. Fetch Officers Data
const rawOfficers = await getActiveOfficerProfilesFromSheets();
const officers = rawOfficers.map((x) => ({
  name: x.name,
  position: x.role,
  bio: x.bio,
  imgSrc: x.photoUrl || "/assets/astro.jpg", 
}));
---

<Layout
  title="About Us"
  description="Mission and Officers of W&M ACM"
  pageTitle="About"
>
<PageHeader title="About Us" subtitle="Workshops, Tech Talks, and Socials" />
  <main class="main-wrapper about-page-container">
    <!-- <header class="page-header-left">
      <h1 class="page-title-small">About Us</h1>
      </header>
      -->
      
      <div class="intro-text">
        <p>
          Founded in 1972, the William & Mary Student Chapter of the Association for Computing Machinery (ACM) 
          has served as the primary academic and social hub for computer science students for over 50 years. 
          Our goal is to foster a community of passion and innovation, helping students learn new technologies, 
          build exciting projects, and prepare for their future careers through our monthly rotation of events.
        </p>
      </div>

    <section class="schedule-section">
        <div class="schedule-container" id="schedule-container">
          <div class="schedule-row">
            <div class="row-text">
              <h3>Workshops</h3>
              <p>
                Once a month, we host a student-led workshop covering a wide range of topics, from 
                introductory Web Development and Python scripting to advanced Artificial Intelligence 
                and System Design. These sessions are designed to give you hands-on experience 
                outside the classroom.
              </p>
            </div>
            <div class="row-image placeholder-bg">
              <span class="sr-only">Workshops Image</span>
            </div>
          </div>

          <div class="schedule-row reverse-layout">
            <div class="row-image placeholder-bg">
               <span class="sr-only">Speaker Event Image</span>
            </div>
            <div class="row-text">
              <h3>Special Events</h3>
              <p>
                We invite industry professionals, alumni, and professors to give tech talks. 
                These events provide insight into the software industry, research opportunities, 
                and career advice, connecting you directly with experts in the field.
              </p>
            </div>
          </div>

          <div class="schedule-row">
            <div class="row-text">
              <h3>Collaborations</h3>
              <p>
                We partner with other student organizations, such as the Society of Women in Computing 
                and various engineering clubs, to host hackathons, coding nights, and 
                interdisciplinary projects that broaden your network and skills.
              </p>
            </div>
            <div class="row-image placeholder-bg">
               <span class="sr-only">Collaboration Image</span>
            </div>
          </div>

          <div class="schedule-row reverse-layout">
            <div class="row-image placeholder-bg">
               <span class="sr-only">Social Event Image</span>
            </div>
            <div class="row-text">
              <h3>Socials</h3>
              <p>
                It's not all code! Come hang out with us for trivia nights, hot chocolate, 
                star gazing, and donuts. It's the perfect time to relax, make friends, 
                and build a supportive community on campus.
              </p>
            </div>
          </div>

        </div>
    </section>
    
    <section class="officers-section">
      <h2 class="section-heading-left">Meet Our Exec:</h2>
      
      <div class="officer-grid">
        {officers.map((officer) => (
          <div class="officer-card">
            <div class="officer-img-container">
               <img src={officer.imgSrc} alt={officer.name} class="officer-img" />
            </div>
            <div class="officer-info">
              <h3 class="officer-name">{officer.name}</h3>
              <span class="officer-role">{officer.position}</span>
              {officer.bio && <p class="officer-bio">{officer.bio}</p>}
            </div>
          </div>
        ))}
      </div>
    </section>
  </main>
</Layout>

<script>
  document.addEventListener('astro:page-load', () => {
    const btn = document.getElementById('expand-btn');
    const hiddenRows = document.getElementById('hidden-rows');
    const container = document.getElementById('schedule-container');

    // Only run if elements exist on the current page
    if (btn && hiddenRows && container) {
      btn.addEventListener('click', () => {
        const isExpanded = hiddenRows.style.maxHeight && hiddenRows.style.maxHeight !== '0px';
        
        if (isExpanded) {
          hiddenRows.style.maxHeight = '0px';
          container.classList.remove('expanded');
          btn.innerHTML = '<span class="arrow-down">▼</span>'; 
        } else {
          hiddenRows.style.maxHeight = hiddenRows.scrollHeight + 'px';
          container.classList.add('expanded');
          btn.innerHTML = '<span class="arrow-up">▲</span>'; 
        }
      });
    }
  });
</script>